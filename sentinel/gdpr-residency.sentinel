# =========================
# GDPR Residency Sentinel Policy
# =========================

import "strings"
import "sockaddr"

check_cidr = rule {
	sockaddr.is_contained(request.connection.remote_addr, "129.41.56.7/32")
}

is_allowed_path = rule {
	strings.has_prefix(request.path, "secret/thai-customers/")
}

main = rule when is_allowed_path {
	check_cidr
}
