# =========================
# GDPR Residency EPG Sentinel Policy
# =========================

import "strings"
import "sockaddr"

precond = rule {
	strings.has_prefix(request.path, "secret/data/thai-customers/")
}

cidr_check = rule {
	sockaddr.is_contained(request.connection.remote_addr, "129.41.56.7/32")
}

main = rule when precond {
	cidr_check
}
